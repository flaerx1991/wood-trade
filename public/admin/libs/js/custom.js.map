{"version":3,"sources":["custom.js"],"names":["dragAndDrop","document","querySelector","uploadsImages","fileTypes","openImageEditForm","name","lang","formWrap","$","val","attr","nameInput","removeClass","selectedLang","addClass","ajax","url","type","cache","data","success","response","JSON","parse","error","jqXHR","textStatus","errorThrown","console","log","css","fadeToggle","closeImageEditForm","changeFormLang","lo","inputSpaceLess","string","split","join","changeImageName","oldName","formData","FormData","append","trim","length","contentType","processData","setImageMeta","alt","title","description","deleteImage","item","remove","uploadImages","messageBlockClasses","messageBlock","slideToggle","className","i","window","location","href","innerHTML","setTimeout","openImageAddingDropzone","dropzone","empty","closeImageAddingDropzone","uploadImagesOnProduct","key","imgGrid","value","Object","entries","deleteImageItem","moveItemLeftRight","direction","element","allElements","querySelectorAll","index","parentNode","insertBefore","clearMeta","array","metaFormObject","each","v","stringify","fromEntries","filter","_","uploadImagesPost","checkFields","meta","serializeArray","getElementsByName","price","properties","more_info","category_select","category","options","selectedIndex","updateImagesPost","path","images","imagesList","getAttribute","selectImageForPage","imageList","closeImgFogmOnPage","addImgToPageField","e","fieldName","imgName","imgPath","fieldP","fieldImg","fieldInput","text","addEventListener","preventDefault","imgTempUrl","files","dataTransfer","classList","add","includes","alreadyIn","test","alert","push","URL","createObjectURL","on","this","splice"],"mappings":"AACA,IAAIA,YAAcC,SAASC,cAAc,kBACrCC,cAAgB,GACpB,MAAMC,UAAY,CAAC,YAAa,aAAc,YAAa,gBAAiB,cA0D5E,SAASC,kBAAkBC,EAAMC,GAC7B,IAAIC,EAAWC,EAAE,uBACjBA,EAAE,uBAAuBC,IAAI,IAC7BD,EAAE,4BAA4BE,KAAK,YAAaJ,GAChD,IAAIK,EAAYH,EAAE,yDAClBG,EAAUD,KAAK,cAAeL,GAC9BM,EAAUF,IAAI,IACdD,EAAE,oCAAoCI,YAAY,wBAClD,IAAIC,EAAeL,EAAE,oCAAoCF,GAEzDO,EAAaC,SAAS,wBAGtBN,EAAEO,KAAK,CACHC,IAAK,yBACLC,KAAM,OACNC,OAAO,EACPC,KAAM,CAACb,KAAMA,EAAMD,KAAMA,GACzBe,QAAS,SAAUC,GAEA,GAAZA,IACCA,EAAWC,KAAKC,MAAMF,GACtBb,EAAE,gCAAgCC,IAAIY,EAAc,KACpDb,EAAE,kCAAkCC,IAAIY,EAAgB,OACxDb,EAAE,wCAAwCC,IAAIY,EAAsB,eAG5EG,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,MAIF,SAA3BpB,EAASuB,IAAI,YACZvB,EAASwB,aAIjB,SAASC,qBACL,IAAIzB,EAAWC,EAAE,uBACjBA,EAAE,yDAAyDC,IAAI,IAIjC,SAA3BF,EAASuB,IAAI,YACZvB,EAASwB,aAIjB,SAASE,eAAe3B,GACpBE,EAAE,oCAAoCI,YAAY,wBAClD,IAAIP,EAAOG,EAAE,yDAAyDE,KAAK,eAC3EkB,QAAQM,GACR9B,kBAAkBC,EAAMC,GAG5B,SAAS6B,eAAeC,GACpB,OAAOA,EAAOC,MAAM,KAAKC,KAAK,IAGlC,SAASC,kBACL,IAAIlC,EAAOG,EAAE,yDAAyDC,MACtE,IAAI+B,EAAUhC,EAAE,yDAAyDE,KAAK,eAC9E,IAAIJ,EAAOE,EAAE,4BAA4BE,KAAK,aAE1C+B,EAAW,IAAIC,SAEnBD,EAASE,OAAO,UAAWH,GAC3BC,EAASE,OAAO,OAAQtC,GAEA,EAArBA,EAAKuC,OAAOC,OACXrC,EAAEO,KAAK,CACHC,IAAK,4BACLC,KAAM,OACN6B,aAAa,EACbC,aAAa,EACb7B,OAAO,EACPC,KAAMsB,EACNrB,QAAS,SAAUC,GACfO,QAAQC,IAAIR,GACG,GAAZA,GACCjB,kBAAkBiB,EAAUf,IAGpCkB,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,MAKhCC,QAAQC,IAAI,cAKpB,SAASmB,eACL,IAGI7B,EAAO,CACPd,KAJOG,EAAE,yDAAyDE,KAAK,eAKvEJ,KAJOE,EAAE,4BAA4BE,KAAK,aAK1CuC,IAAQzC,EAAE,gCAAgCC,MAC1CyC,MAAU1C,EAAE,kCAAkCC,MAC9C0C,YAAgB3C,EAAE,wCAAwCC,OAG9DD,EAAEO,KAAK,CACHC,IAAK,yBACLC,KAAM,OACNC,OAAO,EACPC,KAAMA,EACNC,QAAS,SAAUC,GACfO,QAAQC,IAAIR,IAEhBG,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,MAKpC,SAASyB,cACL,IAAI/C,EAAOG,EAAE,yDAAyDE,KAAK,eAC3E,IAAI2C,EAAOrD,SAASC,cAAc,eAAeI,EAAK,MAEtDG,EAAEO,KAAK,CACHC,IAAK,sBACLC,KAAM,OACNC,OAAO,EACPC,KAAM,CAACd,KAAMA,GACbe,QAAS,SAAUC,GACfO,QAAQC,IAAIR,IAEhBG,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,MAGhC0B,EAAKC,SACLtB,qBAGJ,SAASuB,eAEL,IAAIC,EAAsBxD,SAASC,cAAc,kCAC7CwD,EAAejD,EAAE,kCAEa,SAA/BiD,EAAa3B,IAAI,YAChB2B,EAAaC,YAAY,KAE7BF,EAAoBG,UAAY,UAKhC,IAAIlB,EAAW,IAAIC,SAGnB,GAA0B,EAAvBxC,cAAc2C,OAAY,CAGzB,IAAI,IAAIe,KAAK1D,cACTuC,EAASE,OAAOiB,EAAG1D,cAAc0D,IAGrCpD,EAAEO,KAAK,CACHC,IAAK,uBACLC,KAAM,OACN6B,aAAa,EACbC,aAAa,EACb7B,OAAO,EACPC,KAAMsB,EACNrB,QAAS,SAAUC,GAEA,GAAZA,IACCwC,OAAOC,SAASC,KAAO,kBAI/BvC,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,WAQhC6B,EAAoBQ,UAAY,sCAChCR,EAAoBG,UAAY,cAChCM,WAtCJ,WAA0BR,EAAaC,YAAY,SAsCrB,KAMlC,SAASQ,0BACL,IAAI3D,EAAWC,EAAE,oCACb2D,EAAW3D,EAAE,mDACjB2D,EAASC,QAEqB,SAA3B7D,EAASuB,IAAI,YACZvB,EAASwB,aAIjB,SAASsC,2BACL,IAAI9D,EAAWC,EAAE,oCACFA,EAAE,mDAGa,SAA3BD,EAASuB,IAAI,YACZvB,EAASwB,aAIjB,SAASuC,sBAAsBC,EAAKjE,GAEhC,IAAIkD,EAAsBxD,SAASC,cAAc,kCAC7CwD,EAAejD,EAAE,kCAEa,SAA/BiD,EAAa3B,IAAI,YAChB2B,EAAaC,YAAY,KAE7BF,EAAoBG,UAAY,UAKhC,IAAIlB,EAAW,IAAIC,SAKnB,GAHAD,EAASE,OAAO,QAAS4B,GAGC,EAAvBrE,cAAc2C,OAAY,CAGzB,IAAI,IAAIe,KAAK1D,cACTuC,EAASE,OAAOiB,EAAG1D,cAAc0D,IAGrCpD,EAAEO,KAAK,CACHC,IAAK,kCACLC,KAAM,OACN6B,aAAa,EACbC,aAAa,EACb7B,OAAO,EACPC,KAAMsB,EACNrB,QAAS,SAAUC,GACfA,EAAWC,KAAKC,MAAMF,GACtB,IAAImD,EAAUxE,SAASC,cAAc,gCACrCoE,2BACA,IAAK,GAAM,CAACE,EAAKE,KAAUC,OAAOC,QAAQtD,GACtCmD,EAAQR,WAAa,gCAAiCO,EAAK,gBAAgBE,EAAM,4DAA6DF,EAAK,OAAOjE,EAAK,mEAAoEiE,EAAK,8GAA+GA,EAAK,qFAAsFA,EAAK,yEAAyEE,EAAM,mCAAoCF,EAAK,eAGvjB/C,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,WAMhC6B,EAAoBQ,UAAY,sCAChCR,EAAoBG,UAAY,cAChCM,WAvCJ,WAA0BR,EAAaC,YAAY,SAuCrB,KAIlC,SAASkB,gBAAgBvE,GACrB,IAAIgD,EAAOrD,SAASC,cAAc,eAAeI,EAAK,MACtDgD,EAAKC,SAGT,SAASuB,kBAAkBC,EAAWC,GAElCA,EAAU/E,SAASC,cAAc,eAAe8E,EAAQ,MACxD,IAAIC,EAAchF,SAASiF,iBAAiB,mBAC5C,IAAIC,EAAQ,EAEZ,IAAI,IAAItB,EAAE,EAAGA,EAAIoB,EAAYnC,OAAQe,IAC9BmB,GAAWC,EAAYpB,KAAIsB,EAAQtB,GAG1C,OAAOkB,GACH,IAAK,OACW,GAATI,GACCH,EAAQI,WAAWC,aAAaL,EAASC,EAAYE,EAAM,IAE/D,MACJ,IAAK,QACEA,GAASF,EAAYnC,OAAS,GAC7BkC,EAAQI,WAAWC,aAAcJ,EAAYE,EAAM,GAAIH,IAOvE,SAASM,UAAUC,GACf,IAAIC,EAAiB,GAKrB,OAJA/E,EAAEgF,KAAKF,EACP,SAAS1B,EAAG6B,GACRF,EAAeE,EAAEpF,MAAQoF,EAAEhB,QAExBnD,KAAKoE,UAAWhB,OAAOiB,YAAYjB,OAAOC,QAAQY,GAAgBK,OAAO,CAAA,CAAEC,CAAGJ,KAAY,IAALA,IAAW,MAG3G,SAASK,mBAGL,IAAIC,GAAc,EAGdtD,EAAW,IAAIC,SAEnB,IAAI,IAAIkB,KAAK1D,cACTuC,EAASE,OAAOiB,EAAG1D,cAAc0D,IAIrC,IACIoC,EAAOX,UADI7E,EAAE,wBAAwByF,kBAIrC5F,EAAOL,SAASkG,kBAAkB,QAAQ,GAAGzB,MAC7C0B,EAAQnG,SAASkG,kBAAkB,SAAS,GAAGzB,MAC/C2B,EAAapG,SAASkG,kBAAkB,cAAc,GAAGzB,MACzD4B,EAAYrG,SAASkG,kBAAkB,aAAa,GAAGzB,MACvDtB,EAAcnD,SAASkG,kBAAkB,eAAe,GAAGzB,MAE3D6B,EAAkBtG,SAASkG,kBAAkB,YAAY,GACzDK,EAAWD,EAAgBE,QAAQF,EAAgBG,eAAehC,MAGtEhC,EAASE,OAAO,OAAQtC,GACxBoC,EAASE,OAAO,OAAQqD,GACxBvD,EAASE,OAAO,QAASwD,GACzB1D,EAASE,OAAO,aAAcyD,GAC9B3D,EAASE,OAAO,YAAa0D,GAC7B5D,EAASE,OAAO,cAAeQ,GAC/BV,EAASE,OAAO,WAAY4D,GAGb,KAATlG,GAAiC,KAAf+F,GAAqC,KAAbG,GAAgC,KAAVJ,GAAmC,KAAhBhD,GAAuC,KAAdkD,GAA6C,EAAvBnG,cAAc2C,SAClJkD,GAAc,GAIfA,GAECvF,EAAEO,KAAK,CACHC,IAAK,wBACLC,KAAM,OACN6B,aAAa,EACbC,aAAa,EACb7B,OAAO,EACPC,KAAMsB,EACNrB,QAAS,SAAUC,GACfO,QAAQC,IAAIR,GACZwC,OAAOC,SAASC,KAAO,yBAE3BvC,MAAO,SAASC,EAAOC,EAAYC,GAC/BC,QAAQC,IAAIH,EAAYC,MASxC,SAAS+E,iBAAiBC,EAAMrG,GAG5B,IAAIyF,GAAc,EAGdtD,EAAW,IAAIC,SAEfkE,EAAS5G,SAASiF,iBAAiB,mBACnC4B,EAAa,GACjB,IAAI,IAAIjD,EAAI,EAAGA,EAAIgD,EAAO/D,OAAQe,IAC9BiD,GAAcD,EAAOhD,GAAGkD,aAAa,aAAe,IAIxD,IACId,EAAOX,UADI7E,EAAE,wBAAwByF,kBAIrC5F,EAAOL,SAASkG,kBAAkB,QAAQ,GAAGzB,MAC7C0B,EAAQnG,SAASkG,kBAAkB,SAAS,GAAGzB,MAC/C2B,EAAapG,SAASkG,kBAAkB,cAAc,GAAGzB,MACzD4B,EAAYrG,SAASkG,kBAAkB,aAAa,GAAGzB,MACvDtB,EAAcnD,SAASkG,kBAAkB,eAAe,GAAGzB,MAE3D6B,EAAkBtG,SAASkG,kBAAkB,kBAAkB,GAC/DK,EAAWD,EAAgBE,QAAQF,EAAgBG,eAAehC,MAGtEhC,EAASE,OAAO,OAAQtC,GACxBoC,EAASE,OAAO,OAAQqD,GACxBvD,EAASE,OAAO,QAASwD,GACzB1D,EAASE,OAAO,aAAcyD,GAC9B3D,EAASE,OAAO,YAAa0D,GAC7B5D,EAASE,OAAO,cAAeQ,GAC/BV,EAASE,OAAO,WAAY4D,GAC5B9D,EAASE,OAAO,SAAUkE,GAGX,KAATxG,GAAiC,KAAf+F,GAAqC,KAAbG,GAAgC,KAAVJ,GAAmC,KAAhBhD,GAAuC,KAAdkD,GAAsC,KAAfQ,IACrId,GAAc,GAGfA,GAECvF,EAAEO,KAAK,CACHC,IAAK,yBAA2B2F,EAAM,IAAKrG,EAC3CW,KAAM,OACN6B,aAAa,EACbC,aAAa,EACb7B,OAAO,EACPC,KAAMsB,EAENrB,QAAS,SAAUC,GAEfO,QAAQC,IAAIR,GACZwC,OAAOC,SAASC,KAAO,mBAI3BvC,MAAO,SAASC,EAAOC,EAAYC,OAU/C,SAASoF,mBAAmB1G,GACxB,IAAI2G,EAAYxG,EAAE,8BAClBwG,EAAUtG,KAAK,YAAYL,GAEI,SAA5B2G,EAAUlF,IAAI,YACbkF,EAAUjF,aAKlB,SAASkF,qBACL,IAAID,EAAYxG,EAAE,8BAClBwG,EAAUtG,KAAK,YAAY,IAEI,SAA5BsG,EAAUlF,IAAI,YACbkF,EAAUjF,aAIlB,SAASmF,kBAAkBC,GACvB,IAAIH,EAAYxG,EAAE,8BAClB,IAAI4G,EAAYJ,EAAUtG,KAAK,aAC3B2G,EAAUF,EAAEL,aAAa,aACzBQ,EAAUH,EAAEL,aAAa,aAE7B,IAAIS,EAAS/G,EAAE,gBAAgB4G,EAAU,MACrCI,EAAWhH,EAAE,gBAAgB4G,EAAU,QACvCK,EAAajH,EAAE,gBAAgB4G,EAAU,UAE7CG,EAAOG,KAAKL,GACZI,EAAWhH,IAAI4G,GACfG,EAAS9G,KAAK,MAAO4G,GACrBL,qBA/gBJlH,YAAY4H,iBAAiB,YAAa,IACtCR,EAAES,mBAEN7H,YAAY4H,iBAAiB,YAAa,IACtCR,EAAES,mBAEN7H,YAAY4H,iBAAiB,WAAY,IACrCR,EAAES,mBAIN7H,YAAY4H,iBAAiB,OAAQ,IACjCR,EAAES,iBACepH,EAAE,aAAnB,IAkBgBqH,EAjBVC,EAAQX,EAAEY,aAAaD,MAC7B/H,YAAYiI,UAAUC,IAAI,wBAG1B,IAAI,IAAIrE,EAAI,EAAGA,EAAIkE,EAAMjF,OAAQe,IAC7B,GAAGzD,UAAU+H,SAASJ,EAAMlE,GAAG3C,MAAM,CACjCkH,WAAY,EACZ,IAAI,IAAIC,EAAO,EAAGA,EAAOlI,cAAc2C,OAAQuF,IACxClI,cAAckI,GAAM/H,MAAQyH,EAAMlE,GAAGvD,OACpC8H,WAAY,GAGjBA,UACCE,MAAM,wCAAyCP,EAAMlE,GAAGvD,KAAM,OAG9DH,cAAcoI,KAAKR,EAAMlE,IACrBiE,EAAaU,IAAIC,gBAAgBV,EAAMlE,IAC3CpD,EAAE,kBAAkBmC,OAAO,+DAAgEkF,EAAY,aAAcC,EAAMlE,GAAGvD,KAAM,kBAIxIgI,MAAM,QAASP,EAAMlE,GAAGvD,KAAM,6BAM1CG,EAAE,kBAAkBiI,GAAI,QAAS,wBAAyB,SAAStB,GAC/DA,EAAES,iBACF,IAAIvH,EAAOG,EAAEkI,MAAMhI,KAAK,QAExB,IAAI,IAAIkD,EAAI,EAAGA,EAAI1D,cAAc2C,OAAQe,IAClCvD,GAAQH,cAAc0D,GAAGvD,MACxBH,cAAcyI,OAAO/E,EAAG,GAGhCpD,EAAEkI,MAAMpF","file":"custom.js","sourcesContent":["////// scrip for Dropzone\nlet dragAndDrop = document.querySelector('.drag-and-drop');\nlet uploadsImages = [];\nconst fileTypes = ['image/png', 'image/jpeg', 'image/svg', 'image/svg+xml', 'image/webp'];\n\n// prevent default actions\ndragAndDrop.addEventListener('dragenter', (e) => {\n    e.preventDefault();\n});\ndragAndDrop.addEventListener('dragleave', (e) => {\n    e.preventDefault();\n});\ndragAndDrop.addEventListener('dragover', (e) => {\n    e.preventDefault();\n});\n\n// add images to drop zone\ndragAndDrop.addEventListener('drop', (e) => {\n    e.preventDefault();\n    let inputFiles = $('#inputImg');\n    const files = e.dataTransfer.files;\n    dragAndDrop.classList.add('drag-and-drop-active');\n    // console.log(files);\n    \n    for(let i = 0; i < files.length; i++) {\n        if(fileTypes.includes(files[i].type)){\n            alreadyIn = false;\n            for(let test = 0; test < uploadsImages.length; test++){\n                if(uploadsImages[test].name == files[i].name){\n                    alreadyIn = true;\n                }\n            }\n            if(alreadyIn){\n                alert(`Файл с таким же именем уже добален ( `+ files[i].name +` )`);\n            }\n            else{\n                uploadsImages.push(files[i]);\n                let imgTempUrl = URL.createObjectURL(files[i]);\n                $('.drag-and-drop').append(`<div class=\"drag-and-drop-img\" style=\"background-image: url(`+ imgTempUrl +`);\" href=\"`+ files[i].name +`\"></div>`);\n            }\n        }\n        else{\n            alert('Файл '+ files[i].name +' не подходящего формата');\n        }\n    }\n});\n\n// delete image block from drop zone\n$('.drag-and-drop').on( 'click', 'div.drag-and-drop-img', function(e){\n    e.preventDefault();\n    var name = $(this).attr('href');\n    // imagesToUnlink += name + ' ';\n    for(let i = 0; i < uploadsImages.length; i++){\n        if(name == uploadsImages[i].name){\n            uploadsImages.splice(i, 1);\n        }\n    }\n    $(this).remove();\n} );\n////// script for image editing\n// open form\nfunction openImageEditForm(name, lang) {\n    let formWrap = $('.wt-admin-form-wrap');\n    $('.form-wrap textarea').val('');\n    $('.form-wrap .lang-buttons').attr('data-lang', lang);\n    let nameInput = $('.wt-admin-form-wrap .form-wrap .form-input-image-name');\n    nameInput.attr('placeholder', name);\n    nameInput.val('');\n    $('.wt-admin-form-wrap .lang-button').removeClass(\"lang-button-selected\");\n    let selectedLang = $('.wt-admin-form-wrap .lang-button-'+lang);\n\n    selectedLang.addClass('lang-button-selected');\n\n    // get textarea content\n    $.ajax({\n        url: \"/admin/get-images-meta\",\n        type: \"post\",\n        cache: false,\n        data: {lang: lang, name: name},\n        success: function (response) {\n            // console.log(response);\n            if(response != false) {\n                response = JSON.parse(response);\n                $('.textarea-wrap .textarea-alt').val(response['alt']),\n                $('.textarea-wrap .textarea-title').val(response['title']),\n                $('.textarea-wrap .textarea-description').val(response['description'])\n            }\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            console.log(textStatus, errorThrown);\n        }\n    });\n\n    if(formWrap.css('display') != 'block') {\n        formWrap.fadeToggle();\n    }\n}\n// close form\nfunction closeImageEditForm() {\n    let formWrap = $('.wt-admin-form-wrap');\n    $('.wt-admin-form-wrap .form-wrap .form-input-image-name').val('');\n\n    // $('.form-wrap textarea').text('');\n\n    if(formWrap.css('display') == 'block') {\n        formWrap.fadeToggle();\n    }\n}\n// change form lang\nfunction changeFormLang(lang) {\n    $('.wt-admin-form-wrap .lang-button').removeClass(\"lang-button-selected\");\n    let name = $('.wt-admin-form-wrap .form-wrap .form-input-image-name').attr('placeholder');\n    console.lo\n    openImageEditForm(name, lang);\n}\n// function for prevent spaces in input\nfunction inputSpaceLess(string) {\n    return string.split(' ').join('');\n}\n// change image name\nfunction changeImageName() {\n    let name = $('.wt-admin-form-wrap .form-wrap .form-input-image-name').val();\n    let oldName = $('.wt-admin-form-wrap .form-wrap .form-input-image-name').attr('placeholder');\n    let lang = $('.form-wrap .lang-buttons').attr('data-lang');\n\n    let formData = new FormData();\n\n    formData.append('oldName', oldName);\n    formData.append('name', name);\n\n    if(name.trim().length > 0) {\n        $.ajax({\n            url: \"/admin/change-images-name\",\n            type: \"post\",\n            contentType: false,\n            processData: false,\n            cache: false,\n            data: formData,\n            success: function (response) {\n                console.log(response);\n                if(response != false){\n                    openImageEditForm(response, lang);\n                }\n            },\n            error: function(jqXHR, textStatus, errorThrown) {\n                console.log(textStatus, errorThrown);\n            }\n        });\n    }\n    else {\n        console.log('empty name');\n    }\n    \n}\n// change image meta\nfunction setImageMeta() {\n    let name = $('.wt-admin-form-wrap .form-wrap .form-input-image-name').attr('placeholder');\n    let lang = $('.form-wrap .lang-buttons').attr('data-lang');\n    \n    let data = {\n        \"name\": name,\n        \"lang\": lang,\n        \"alt\" : $('.textarea-wrap .textarea-alt').val(),\n        \"title\" : $('.textarea-wrap .textarea-title').val(),\n        \"description\" : $('.textarea-wrap .textarea-description').val()\n    }\n\n    $.ajax({\n        url: \"/admin/set-images-meta\",\n        type: \"post\",\n        cache: false,\n        data: data,\n        success: function (response) {\n            console.log(response);\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            console.log(textStatus, errorThrown);\n        }\n    });\n}\n// delete image\nfunction deleteImage() {\n    let name = $('.wt-admin-form-wrap .form-wrap .form-input-image-name').attr('placeholder');\n    let item = document.querySelector('[data-name=\"'+name+'\"]');\n\n    $.ajax({\n        url: \"/admin/delete-image\",\n        type: \"post\",\n        cache: false,\n        data: {name: name},\n        success: function (response) {\n            console.log(response);\n        },\n        error: function(jqXHR, textStatus, errorThrown) {\n            console.log(textStatus, errorThrown);\n        }\n    });\n    item.remove();\n    closeImageEditForm();\n}\n// upload images\nfunction uploadImages() {\n\n    let messageBlockClasses = document.querySelector(\".images-message-block .message\");\n    let messageBlock = $(\".images-message-block .message\");\n\n    if(messageBlock.css(\"display\") == \"block\"){\n        messageBlock.slideToggle(100);\n    }\n    messageBlockClasses.className = \"message\";\n\n    function timeoutToggle() {messageBlock.slideToggle(\"slow\");}\n\n    // create virtual form\n    let formData = new FormData();\n\n    // check filling images\n    if(uploadsImages.length > 0) {\n\n        // add all imades to form\n        for(let i in uploadsImages){\n            formData.append(i, uploadsImages[i]);\n        }\n\n        $.ajax({\n            url: \"/admin/upload-images\",\n            type: \"post\",\n            contentType: false,\n            processData: false,\n            cache: false,\n            data: formData,\n            success: function (response) {\n                // console.log(response);\n                if(response == true) {\n                    window.location.href = \"/admin/images\";\n                    // console.log('true');\n                }\n            },\n            error: function(jqXHR, textStatus, errorThrown) {\n                console.log(textStatus, errorThrown);\n            }\n        });\n            \n        // messageBlockClasses.className = \"message good\";\n        // setTimeout(timeoutToggle, 400);\n    }\n    else{\n        messageBlockClasses.innerHTML = \"Не добавлено ни единого изображения\"\n        messageBlockClasses.className = \"message bad\";\n        setTimeout(timeoutToggle, 400);\n    }\n}\n\n////// script for image editing on product page\n// open form for adding new images\nfunction openImageAddingDropzone() {\n    let formWrap = $('.wt-admin-product-dragndrop-wrap');\n    let dropzone = $('.wt-admin-product-dragndrop-wrap .drag-and-drop');\n    dropzone.empty();\n\n    if(formWrap.css('display') != 'block') {\n        formWrap.fadeToggle();\n    }\n}\n// close form for adding new images\nfunction closeImageAddingDropzone() {\n    let formWrap = $('.wt-admin-product-dragndrop-wrap');\n    let dropzone = $('.wt-admin-product-dragndrop-wrap .drag-and-drop');\n    // dropzone.empty();\n\n    if(formWrap.css('display') == 'block') {\n        formWrap.fadeToggle();\n    }\n}\n// add image to form and to storage\nfunction uploadImagesOnProduct(key, lang) {\n\n    let messageBlockClasses = document.querySelector(\".images-message-block .message\");\n    let messageBlock = $(\".images-message-block .message\");\n\n    if(messageBlock.css(\"display\") == \"block\"){\n        messageBlock.slideToggle(100);\n    }\n    messageBlockClasses.className = \"message\";\n\n    function timeoutToggle() {messageBlock.slideToggle(\"slow\");}\n\n    // create virtual form\n    let formData = new FormData();\n\n    formData.append('p_key', key);\n\n    // check filling images\n    if(uploadsImages.length > 0) {\n\n        // add all imades to form\n        for(let i in uploadsImages){\n            formData.append(i, uploadsImages[i]);\n        }\n\n        $.ajax({\n            url: \"/admin/upload-images-to-product\",\n            type: \"post\",\n            contentType: false,\n            processData: false,\n            cache: false,\n            data: formData,\n            success: function (response) {\n                response = JSON.parse(response);\n                let imgGrid = document.querySelector('.wt-admin-img-form .img-grid');\n                closeImageAddingDropzone();\n                for (const [key, value] of Object.entries(response)) {\n                    imgGrid.innerHTML += \"<div class='item' data-name='\"+ key +\"' data-path='\"+value+\"'> <div class='edit-button' onclick=\\\"openImageEditForm('\"+ key +\"', '\"+lang+\"')\\\"></div> <div class='delete-item' onclick=\\\"deleteImageItem('\"+ key +\"')\\\"></div> <div class='move-buttons'> <div class='move-buttons-left' onclick=\\\"moveItemLeftRight('left', '\"+ key +\"')\\\"></div> <div class='move-buttons-right' onclick=\\\"moveItemLeftRight('right', '\"+ key +\"')\\\"></div> </div> <div class='img-item' style='background-image: url(\"+value+\");'></div> <p class='item-text'>\"+ key +\"</p> </div>\";\n                }\n            },\n            error: function(jqXHR, textStatus, errorThrown) {\n                console.log(textStatus, errorThrown);\n            }\n        });\n\n    }\n    else{\n        messageBlockClasses.innerHTML = \"Не добавлено ни единого изображения\"\n        messageBlockClasses.className = \"message bad\";\n        setTimeout(timeoutToggle, 400);\n    }\n}\n// remove image item from form\nfunction deleteImageItem(name) {\n    let item = document.querySelector('[data-name=\"'+name+'\"]');\n    item.remove();\n}\n// move image items\nfunction moveItemLeftRight(direction, element) {\n\n    element = document.querySelector('[data-name=\"'+element+'\"]');\n    let allElements = document.querySelectorAll('.img-grid .item');\n    let index = 0;\n\n    for(let i=0; i < allElements.length; i++) {\n        if(element == allElements[i]) index = i;\n    }\n\n    switch(direction) {\n        case 'left':\n            if(index != 0){\n                element.parentNode.insertBefore(element, allElements[index-1] );\n            }\n            break\n        case 'right':\n            if(index != allElements.length - 1){\n                element.parentNode.insertBefore( allElements[index+1], element);\n            }\n            break\n    }\n}\n\n\nfunction clearMeta(array) {\n    let metaFormObject = {};\n    $.each(array,\n    function(i, v) {\n        metaFormObject[v.name] = v.value;\n    });\n    return JSON.stringify( Object.fromEntries(Object.entries(metaFormObject).filter(([_, v]) => v != '')), null );\n}\n\nfunction uploadImagesPost() {\n\n    // create filled check variable\n    let checkFields = false;\n    \n    // get all images\n    let formData = new FormData();\n\n    for(let i in uploadsImages){\n        formData.append(i, uploadsImages[i]);\n    }\n\n    // get meta inputs\n    let metaForm = $('#product_meta :input').serializeArray();\n    let meta = clearMeta(metaForm);\n\n    // get all inputs except category\n    let name = document.getElementsByName('name')[0].value;\n    let price = document.getElementsByName('price')[0].value;\n    let properties = document.getElementsByName('properties')[0].value;\n    let more_info = document.getElementsByName('more_info')[0].value;\n    let description = document.getElementsByName('description')[0].value;\n\n    let category_select = document.getElementsByName('category')[0];\n    var category = category_select.options[category_select.selectedIndex].value;\n\n    // adding all inputs to virtual form\n    formData.append('name', name);\n    formData.append('meta', meta);\n    formData.append('price', price);\n    formData.append('properties', properties);\n    formData.append('more_info', more_info); \n    formData.append('description', description);\n    formData.append('category', category);\n\n    // check filling\n    if( !(name === \"\") && !(properties === \"\") && !(category === \"\") && !(price === \"\") && !(description === \"\") && !(more_info === \"\") && (uploadsImages.length > 0) ){\n        checkFields = true;\n    }\n\n\n    if(checkFields){\n\n        $.ajax({\n            url: \"/admin/upload-product\",\n            type: \"post\",\n            contentType: false,\n            processData: false,\n            cache: false,\n            data: formData,\n            success: function (response) {\n                console.log(response);\n                window.location.href = \"/admin/create-product\";\n            },\n            error: function(jqXHR, textStatus, errorThrown) {\n                console.log(textStatus, errorThrown);\n            }\n        });\n\n    }\n    \n\n}\n\nfunction updateImagesPost(path, lang) {\n\n    // create filled check variable\n    let checkFields = false;\n\n    // get all images and images for remove\n    let formData = new FormData();\n\n    let images = document.querySelectorAll('.img-grid .item');\n    let imagesList = '';\n    for(let i = 0; i < images.length; i++){\n        imagesList += images[i].getAttribute('data-name') + ' ';\n    }\n\n    // get meta inputs\n    let metaForm = $('#product_meta :input').serializeArray();\n    let meta = clearMeta(metaForm);\n\n    // get all inputs except category\n    let name = document.getElementsByName('name')[0].value;\n    let price = document.getElementsByName('price')[0].value;\n    let properties = document.getElementsByName('properties')[0].value;\n    let more_info = document.getElementsByName('more_info')[0].value;\n    let description = document.getElementsByName('description')[0].value;\n\n    let category_select = document.getElementsByName('categorySelect')[0];\n    var category = category_select.options[category_select.selectedIndex].value;\n\n    // adding all inputs to virtual form\n    formData.append('name', name);\n    formData.append('meta', meta);\n    formData.append('price', price);\n    formData.append('properties', properties);\n    formData.append('more_info', more_info);\n    formData.append('description', description);\n    formData.append('category', category);\n    formData.append('images', imagesList);\n\n    // check filling\n    if( !(name === \"\") && !(properties === \"\") && !(category === \"\") && !(price === \"\") && !(description === \"\") && !(more_info === \"\") && !(imagesList === \"\")){\n        checkFields = true;\n    }\n\n    if(checkFields){\n\n        $.ajax({\n            url: \"/admin/update-product/\" + path +\"/\"+ lang,\n            type: \"post\",\n            contentType: false,\n            processData: false,\n            cache: false,\n            data: formData,\n            //data : { \"images\" : formData.getAll('images') },\n            success: function (response) {\n                // setTimeout(document.location.reload(), 50);\n                console.log(response);\n                window.location.href = \"/admin/products\";\n                \n    \n            },\n            error: function(jqXHR, textStatus, errorThrown) {\n                //console.log(textStatus, errorThrown);\n            }\n        });\n\n    }\n    // console.log(uploadsImages);\n}\n\n//////// Page select image\nfunction selectImageForPage(name) {\n    let imageList = $('.wt-admin-img-form-on-page');\n    imageList.attr('data-name',name);\n\n    if(imageList.css('display') != 'block') {\n        imageList.fadeToggle();\n    }\n    // console.log(name);\n}\n\nfunction closeImgFogmOnPage() {\n    let imageList = $('.wt-admin-img-form-on-page');\n    imageList.attr('data-name','');\n\n    if(imageList.css('display') == 'block') {\n        imageList.fadeToggle();\n    }\n}\n\nfunction addImgToPageField(e) {\n    let imageList = $('.wt-admin-img-form-on-page');\n    let fieldName = imageList.attr('data-name');\n    let imgName = e.getAttribute('data-name');\n    let imgPath = e.getAttribute('data-path');\n\n    let fieldP = $('#image_field_'+fieldName+' p');\n    let fieldImg = $('#image_field_'+fieldName+' img');\n    let fieldInput = $('#image_field_'+fieldName+' input');\n\n    fieldP.text(imgName);\n    fieldInput.val(imgName);\n    fieldImg.attr('src', imgPath);\n    closeImgFogmOnPage();\n}"]}